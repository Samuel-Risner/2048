(()=>{"use strict";const e={durationMS:750},t={size:4},n={widthPerUnitPx:100};function*i(e,t,n){for(let i=0;i<n;i++)yield[e[i][t],t,i];return null}function*l(e,n,i){for(let l=t.size-1;l>t.size-i;l--)yield[e[l][n],n,l];return null}function*o(e,t,n){for(let i=0;i<n;i++)yield[e[t][i],i,t];return null}function*s(e,n,i){for(let l=t.size-1;l>t.size-i;l--)yield[e[n][l],l,n];return null}function r(e,t,i,l){e.style.top=l*n.widthPerUnitPx+"px",e.style.left=i*n.widthPerUnitPx+"px"}class a{x;y;positionElement;colorElement;textElement;value;hasMerged;constructor(e,t,i){var l;this.x=e,this.y=t,this.positionElement=document.createElement("div"),this.colorElement=document.createElement("div"),this.textElement=document.createElement("div"),(l=this.positionElement).style.position="absolute",l.style.width=`${n.widthPerUnitPx}px`,l.style.height=`${n.widthPerUnitPx}px`,l.style.display="flex",r(this.positionElement,0,e,t),function(e){e.style.backgroundColor="white",e.style.width="90%",e.style.height="90%",e.style.display="flex",e.style.margin="auto",e.style.borderRadius="10%"}(this.colorElement),function(e){e.style.display="flex",e.style.margin="auto",e.style.fontSize=n.widthPerUnitPx/3+"px"}(this.textElement),this.setValue(2),i.appendChild(this.positionElement),this.positionElement.appendChild(this.colorElement),this.colorElement.appendChild(this.textElement),this.hasMerged=!1}setValue(e){switch(this.value=e,this.textElement.textContent=String(e),e){case 2:this.colorElement.style.backgroundColor="#FCD0A1";break;case 4:this.colorElement.style.backgroundColor="#B1B695";break;case 8:this.colorElement.style.backgroundColor="#A690A4";break;case 16:this.colorElement.style.backgroundColor="#5E4B56";break;case 32:this.colorElement.style.backgroundColor="#AFD2E9";break;case 64:this.colorElement.style.backgroundColor="#F42272";break;case 128:this.colorElement.style.backgroundColor="#F397D6";break;case 256:this.colorElement.style.backgroundColor="#D7B8F3";break;case 512:this.colorElement.style.backgroundColor="#B8B8F3";break;case 2048:this.colorElement.style.backgroundColor="#deb841";break;default:this.colorElement.style.backgroundColor="white"}}getValue(){return this.value}getX(){return this.x}getY(){return this.y}getHasMerged(){return this.hasMerged}setHasMerged(e){this.hasMerged=e}remove(){this.positionElement.remove()}setAnimation(t,i,l,o){const s=this.positionElement.animate([{left:this.x*n.widthPerUnitPx+"px",top:this.y*n.widthPerUnitPx+"px"},{left:t*n.widthPerUnitPx+"px",top:i*n.widthPerUnitPx+"px"}],{duration:e.durationMS,iterations:1});this.x=t,this.y=i,s.onfinish=()=>{s.cancel(),o?.remove(),this.setValue(l),r(this.positionElement,0,this.x,this.y)}}}const u=document.getElementById("root");function d(){const e=window.innerWidth,i=window.innerHeight;if(e>i){const l=i/(t.size*n.widthPerUnitPx);u.style.transform=`scale(${l})`,u.style.left=(e-t.size*n.widthPerUnitPx*l)/2+"px",u.style.top="0px"}else{const l=e/(t.size*n.widthPerUnitPx);u.style.transform=`scale(${l})`,u.style.left="0px",u.style.top=(i-t.size*n.widthPerUnitPx*l)/2+"px"}}window.onload=()=>{d(),window.onresize=d},u.style.width=t.size*n.widthPerUnitPx+"px",u.style.height=t.size*n.widthPerUnitPx+"px",u.style.position="relative",u.style.transformOrigin="0% 0% 0px";let c=!1;const h=[];for(let e=0;e<4;e++){h.push([]);for(let t=0;t<4;t++)h[e][t]=null}function f(){const e=[];for(let t=0;t<h.length;t++)for(let n=0;n<h[t].length;n++)null===h[t][n]&&e.push([n,t]);if(0===e.length)return!1;const[t,n]=e[Math.floor(Math.random()*e.length)];return h[n][t]=new a(t,n,u),!0}function g(n){for(const e of n)for(let n=0;n<t.size;n++){const t=e();let n=t.next().value;if(null===n)continue;let[i,l,o]=n,s=i;for(const[e,n,r]of t)if(null!==e)if(null!==i){{let t=e.getValue();if(null!==s&&s.getValue()===t&&!s.getHasMerged()){e.setAnimation(s.getX(),s.getY(),2*t,s),h[s.getY()][s.getX()]=e,h[r][n]=null,e.setHasMerged(!0),s.setHasMerged(!0);continue}}i=e,s=e}else{let t=e.getValue();if(null!==s&&s.getValue()===t&&!s.getHasMerged()){e.setAnimation(s.getX(),s.getY(),2*t,s),h[s.getY()][s.getX()]=e,h[r][n]=null,e.setHasMerged(!0),s.setHasMerged(!0);continue}e.setAnimation(l,o,t,null),h[o][l]=e,h[r][n]=null}else{if(null===i)continue;l=n,o=r,i=e}}!function(){for(const e of h)for(const t of e)null!==t&&t.setHasMerged(!1)}(),setTimeout((()=>{f(),c=!1}),e.durationMS)}document.addEventListener("keydown",(e=>{if(!c)switch(c=!0,e.code){case"ArrowUp":return void g(function*(e){for(let n=0;n<t.size;n++)for(let l=0;l<t.size+1;l++)yield()=>i(e,n,l);return null}(h));case"ArrowDown":return void g(function*(e){for(let n=0;n<t.size;n++)for(let i=1;i<t.size+2;i++)yield()=>l(e,n,i);return null}(h));case"ArrowLeft":return void g(function*(e){for(let n=0;n<e.length;n++)for(let i=1;i<t.size+1;i++)yield()=>o(e,n,i);return null}(h));case"ArrowRight":return void g(function*(e){for(let n=0;n<t.size;n++)for(let i=1;i<t.size+2;i++)yield()=>s(e,n,i);return null}(h));default:return void(c=!1)}})),f(),f(),u.hidden=!1})();